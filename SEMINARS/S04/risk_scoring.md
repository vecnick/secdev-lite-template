# Приоритизация рисков L×I для системы автоматизации поиска работы

## Таблица приоритизации рисков

| Risk ID | Source (DFD/Row) | Consolidated Description | Threat (S/T/R/I/D/E) | NFR link (ID) | L (1-5) | Rationale-L | I (1-5) | Rationale-I | **Score (=L×I)** | Decision (Top-5?) | ADR candidate |
| ------- | ---------------- | ------------------------ | -------------------- | ------------- | ------: | ----------- | ------: | ----------- | ---------------: | ----------------- | ------------- |
| R-01 | Edge: Internet → Controller | Подмена OAuth токена при авторизации через HH.ru | S | NFR-005 | 4 | Публичный эндпоинт, стандартные атаки на OAuth | 5 | Полный доступ к аккаунту пользователя, компрометация PII | 20 | Top-1 | OAuth Security Hardening |
| R-02 | Edge: Business Logic → HH.ru API | Блокировка аккаунта из-за превышения лимитов API | D | NFR-002 | 4 | Частые автоматические запросы, жесткие лимиты HH.ru | 4 | Потеря основного функционала системы | 16 | Top-2 | Adaptive Rate Limiting Strategy |
| R-03 | Node: PostgreSQL | Несанкционированный доступ к PII данным пользователей | I | NFR-006 | 3 | Требует доступа к БД, но данные высокоценные | 5 | Массовая утечка персональных данных, GDPR нарушения | 15 | Top-3 | PII Data Encryption Framework |
| R-04 | Edge: Business Logic → External APIs | Недоступность внешних API (HH.ru, Telegram) | D | NFR-008 | 3 | Внешние зависимости, возможны сбои | 4 | Критичный функционал недоступен | 12 | Top-4 | External API Resilience Pattern |
| R-05 | Node: Business Logic | Обход проверок прав доступа к данным других пользователей | E | need NFR | 3 | Сложная бизнес-логика, возможны ошибки в проверках | 4 | Доступ к чужим данным, нарушение конфиденциальности | 12 | Top-5 | Strict RBAC Implementation |
| R-06 | Edge: Internet → Controller | DoS через массовые запросы к API | D | NFR-001, NFR-002 | 4 | Публичное API, легко атаковать | 3 | Временная недоступность, но есть graceful degradation | 12 | Alternate | DDoS Protection Layer |
| R-07 | Edge: Business Logic → PostgreSQL | SQL инъекции через уязвимости в ORM/запросах | T | NFR-009 | 2 | Современные ORM снижают риск, но возможны ошибки | 5 | Полный компромисс БД | 10 | - | SQL Injection Prevention |
| R-08 | Node: Ollama Integration | Утечка PII через ИИ-модель в логах | I | need NFR | 3 | PII может случайно попасть в промпты | 3 | Утечка отдельных PII, но не массовая | 9 | - | AI Prompt Sanitization |
| R-09 | Edge: Telegram Bot API → Business Logic | Подмена webhook событий от Telegram | S | NFR-005 | 3 | Требует знания secret, но возможны атаки | 3 | Ложные уведомления, но ограниченный ущерб | 9 | - | Webhook Verification |
| R-10 | Node: Redis | Исчерпание памяти через атаку на кэш | D | need NFR | 2 | Специфичная атака, требует знаний системы | 4 | Деградация производительности | 8 | - | Cache Protection Mechanisms |

## Сводка Top-5 рисков

### Top-1: R-01 - Подмена OAuth токена при авторизации через HH.ru
- **Score:** 20 (L=4, I=5)
- **Обоснование:** Высокая вероятность из-за публичного характера эндпоинта и стандартных атак на OAuth. Критическое воздействие - полный компромисс аккаунта пользователя.
- **ADR candidate:** OAuth Security Hardening

### Top-2: R-02 - Блокировка аккаунта из-за превышения лимитов HH.ru API
- **Score:** 16 (L=4, I=4)
- **Обоснование:** Частые автоматические запросы создают высокий риск превышения лимитов. Воздействие - потеря основного функционала системы.
- **ADR candidate:** Adaptive Rate Limiting Strategy

### Top-3: R-03 - Несанкционированный доступ к PII данным пользователей
- **Score:** 15 (L=3, I=5)
- **Обоснование:** Хотя доступ к БД требует усилий, воздействие критическое - массовая утечка персональных данных и нарушения GDPR.
- **ADR candidate:** PII Data Encryption Framework

### Top-4: R-04 - Недоступность внешних API (HH.ru, Telegram)
- **Score:** 12 (L=3, I=4)
- **Обоснование:** Внешние зависимости создают умеренный риск сбоев, но воздействие значительное - критичный функционал становится недоступным.
- **ADR candidate:** External API Resilience Pattern

### Top-5: R-05 - Обход проверок прав доступа к данным других пользователей
- **Score:** 12 (L=3, I=4)
- **Обоснование:** Сложная бизнес-логика увеличивает вероятность ошибок в проверках прав. Воздействие - доступ к конфиденциальным данным других пользователей.
- **ADR candidate:** Strict RBAC Implementation